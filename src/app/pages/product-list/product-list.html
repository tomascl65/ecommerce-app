<div class="container mx-auto px-4 py-8">
  <h1 class="text-3xl font-bold text-gray-800 mb-6">Lista de Productos</h1>

  <!-- Formulario de búsqueda -->
  <div class="mb-8">
    <div [formGroup]="searchForm" class="flex flex-col md:flex-row gap-4">
      <div class="flex-1 relative">
        <input
          type="text"
          formControlName="searchTerm"
          placeholder="Buscar por nombre, categoría..."
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition-shadow"
          [class.border-red-500]="searchTermControl.invalid && searchTermControl.touched"
        />
        <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
          <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            ></path>
          </svg>
        </div>
      </div>
    </div>

    @if (searchTermControl.invalid && searchTermControl.touched) {
      <div class="mt-2 text-red-500 text-sm">
        @if (searchTermControl.errors?.['required']) {
          <span>El campo es requerido.</span>
        }
        @if (searchTermControl.errors?.['minlength']) {
          <span>Mínimo 3 caracteres.</span>
        }
      </div>
    }
  </div>

  <!-- Loading State -->
  @if (loading()) {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      @for (item of [1, 2, 3, 4, 5, 6, 7, 8]; track item) {
        <div class="bg-white rounded-lg shadow-md overflow-hidden animate-pulse">
          <div class="h-48 bg-gray-200"></div>
          <div class="p-4 space-y-3">
            <div class="h-4 bg-gray-200 rounded w-3/4"></div>
            <div class="h-3 bg-gray-200 rounded w-1/2"></div>
            <div class="h-6 bg-gray-200 rounded w-1/4"></div>
            <div class="h-10 bg-gray-200 rounded w-full mt-4"></div>
          </div>
        </div>
      }
    </div>
  }

  <!-- Error State -->
  @else if (error()) {
    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded text-red-700" role="alert">
      <p class="font-bold">Error</p>
      <p>{{ error() }}</p>
    </div>
  }

  <!-- Data State -->
  @else {
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      @for (product of filteredProducts(); track product.id) {
        <app-product-card [product]="product"></app-product-card>
      } @empty {
        <div class="col-span-full text-center py-12">
          <p class="text-gray-500 text-lg">No se encontraron productos.</p>
        </div>
      }
    </div>
  }
</div>
